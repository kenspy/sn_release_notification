<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[// Show info message on form saved.
function onOk() {
    var grForm = new GlideForm();
    grForm.addInfoMessage('Notes color saved!');
	GlideDialogWindow.get().destroy();
// 	reloadWindow(window);
	return false;
}

function onCancel() {
	GlideDialogWindow.get().destroy();
// 	reloadWindow(window);
	return false;
}

function initColor() {
	var colorPicker;
    colorPicker = $j(".color_input").each(function() {
        var id = $j(this).attr("id");
        var input = $j("#" + id);
        updateColor(id, input);
		noteProps();
    });
}
initColor();

function updateColor(id, input) {
    input.on("input", function() {
        var color = input.val();
        var value = $j("#" + id + "-value").val();
        $j("#" + id + "-value").val(color);
        noteProps();
    });
    input.select();
}

function noteProps() {
    var noteArr = [];

    colorPicker = $j(".color_input").each(function() {
        var colorId = $j(this).attr("id");
		var name = $j("#" + colorId + "-name").val();
        var color = $j("#" + colorId + "-value").val();
        noteArr.push({
			name: name,
			color: color
		});
    });
	$j("input#rntc_props").val(JSON.stringify(noteArr));
}]]></client_script>
        <description>Handles the release note color mapping</description>
        <direct>false</direct>
        <endpoint>x_803596_release_0_release_note_color.do</endpoint>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
	<g:requires name="scripts/lib/jquery_includes.js"/>
	<style>
		body {
			background: rgba(0,0,0,0.05);
		}
		.title {
			width: 70%;
			float: left;
		}
		.title h4 {
			width: 100%;
			float:left
		}
		.row {
			margin-bottom: 20px;
		}
		.card {
			background-color: RGB(var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255,255)));
			padding: 0 12px 12px;
			border-radius: 8px;
			display: grid;
		}
		.card-title {
			font-weight: 600;
			border-bottom: 1px solid #ddd;
			padding: 12px 0;
		}
		.email_template {
			width: 80%;
			float: left;
		}
		.email_preview {
			width: 20%;
			float: left;
		}
		td#label\.release_note_types {
			display: none;
		}
		textarea#release_note_types {
			border: 1px solid #a1a1a1;
			border-radius: 4px;
			resize: none;
			overflow: hidden;
			overflow-wrap: break-word;
		}
		.option {
			margin-bottom: 15px;
		}
		textarea, input, select, .email_icon {
			box-shadow: 0 0 0 0 RGBA(var(--now-color--primary-1,30,133,109),.1),inset 0 0 0 0 RGB(var(--now-color--primary-1,30,133,109)),inset 0 0 0 0 RGB(var(--now-color--neutral-0,255,255,255)),inset 0 2px 0 1px RGBA(var(--now-color--neutral-18,22,27,28),.1);
			background: RGB(var(--now-form-field--background-color,var(--now-color_background--primary,var(--now-color--neutral-0,255,255,255))));
		}
		textarea:focus, input:focus, select:focus, .email_icon:focus {
			box-shadow: inset 0 0 0 1px RGB(var(--now-form-field--border-color--focus,var(--now-color--secondary-1,1,119,142))),0 0 0 4px RGBA(var(--now-form-field--border-color--focus,var(--now-color--secondary-1,1,119,142)),.1);
			border-color: RGB(var(--now-form-field--border-color--focus,var(--now-color--secondary-1,1,119,142)));
			outline: 0;
		}
		.option input, .option select {
			width: 100%;
			height: 32px;
			border-radius: 4px;
			border: 1px solid #a1a1a1;
			padding: 0 7px;
		}
		.option input {
			border-radius: 4px 0 0 4px;
		}
		.email_icon {
			border: 1px solid #838383;
			border-radius: 0 4px 4px 0;
			margin-left: -4px;
			padding: 6.5px 9px 6.5px;
			display: inline-block;
		}
		.email_icon span {
			padding-left: 4px;
		}
		.chip {
			padding: 10px 0;
			float: left;
			width: 100%;
			text-align: center;
		}
		.chip span, .chip .note_type {
			border: 1px solid #1b98dd;
			padding: 2px 10px;
			border-radius: 11px;
			margin: 3px;
			cursor: pointer;
		}
		.chip span.color {
			background: grey;
			border-radius: 100%;
			margin-right: -12px;
			margin-left: 6px;
			border: none;
		}
		.option select {
			margin: 4px 10px;
		}
		label.control-label {
			display: none;
		}
		.chip table {
			display: inline-block;
		}
		.color_picker {
			display: inline-block;
			width: 30px;
			vertical-align: super;
		}
		.color_picker input {
			padding: 1px;
			border-radius: 0 4px 4px 0;
			cursor: pointer;
		}
	</style>
	<div id="release_properties" style="margin:20px;">
		<div class="form-container">
			<g:ui_form>
				<header>
					<div class="title">
						<h4>Release Notes Color</h4>
					</div>
					<div class="right-menu" style="float:right;">
						<g:dialog_buttons_ok_cancel ok='return onOk()' cancel='onCancel()'/>
					</div>
				</header>
				<main style="margin:auto; max-width: 468px;">	
					<div class="row">
					  <div class="col-sm-6 col-md-6" >
						
					  </div>
					</div>
					
					<div class="row">
						<div class="card">
							<div class="card-body">
								<h5 class="card-title">Choose color </h5>
								<p class="card-text">
									<div class="option">
										<g:evaluate>
												var index = 0;
												var rnt_values = [];
												var note_types = [];
												var grRE = new GlideRecordSecure("sys_choice");
												grRE.addEncodedQuery("name=x_803596_release_0_release_notes");
												grRE.query();
												
												var rntc = gs.getProperty("x_803596_release_0.release_note_type_color");
												
												if (rntc.length > 0) {
													var rntc_values = JSON.parse(rntc);
													while (grRE.next()) {
														index++;
														if (grRE.value == rntc_values[index - 1].name) {
															rnt_values.push({
																value: grRE.getValue("value"),
																name: grRE.getDisplayValue(),
																color: rntc_values[index - 1].color
															});
														} 
													}	
												} else {
													while (grRE.next()) {
														rnt_values.push({
															value: grRE.getValue("value"),
															name: grRE.getDisplayValue(),
															color: "#eee"
														});
													}	
												
												}		   

											</g:evaluate>
										
										<div id="rnt_chip" class="chip">
											<table><tbody>
												<j:forEach var="jvar_rnt" items="${rnt_values}">
													<tr>
														<td height="23px"><span class="note_type" id="${jvar_rnt.value}-name">${jvar_rnt.name}</span></td>
														<input type="hidden" name="${jvar_rnt.value}-color-name" value="${jvar_rnt.value}" id="${jvar_rnt.value}-color-name"/>
														<td>
															
															<g:ui_input_field name="${jvar_rnt.value}-color-value" value="${jvar_rnt.color}" />
															
															<div class="color_picker">
																<input type="color" class="color_input" value="${jvar_rnt.color}" id="${jvar_rnt.value}-color" />
															</div>
														</td>
													</tr>
												</j:forEach>
												<tr><td><input type="hidden" name="rntc_props" value="" id="rntc_props"/></td></tr>
											</tbody></table>
										</div>
									</div>
								</p>
							</div>
						</div>
					</div>
				</main>
			</g:ui_form>
		</div>
	</div>
</j:jelly>]]></html>
        <name>release_note_color</name>
        <processing_script><![CDATA[gs.setProperty("x_803596_release_0.release_note_type_color", rntc_props);
]]></processing_script>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-06-22 01:35:55</sys_created_on>
        <sys_id>d026f1829723e510c6d1b666f053afd8</sys_id>
        <sys_mod_count>174</sys_mod_count>
        <sys_name>release_note_color</sys_name>
        <sys_package display_value="Release Notification" source="x_803596_release_0">4b83d29897e32110c6d1b666f053afd4</sys_package>
        <sys_policy/>
        <sys_scope display_value="Release Notification">4b83d29897e32110c6d1b666f053afd4</sys_scope>
        <sys_update_name>sys_ui_page_d026f1829723e510c6d1b666f053afd8</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-07-06 23:51:19</sys_updated_on>
    </sys_ui_page>
</record_update>
